<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visualization Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" >
  <style>
    body{
        background-color: #EEEEEE;
        color: #232931;
    }
    .card{
        border-radius: 15px;
    }
    .form-group {
        text-align: right !important;
      }
    @media (max-width: 576px) {
        .form-group {
          text-align: left !important;
        }
      }

  </style>
</head>
<body>
    <div class='container'>
        <div class="card my-2 mb-1">
            <div class="card-body p-3">
                <h1 style="padding-left: 60px; display: inline-block;">Django Dashboard - Filter</h1>
                <a class="btn btn-outline-primary float-end" href="{% url 'filter' %}">Filter <i class="fa fa-filter"></i></a>
            </div>
        </div>
        <div class='card my-2'>
            <div class="card-body" >
                <form action="http://127.0.0.1:8000/api/filter/" method="get" >
                    <div class="form-group row ">
                    <label class="col-sm-4 col-form-label my-1">Intensity Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="intensity-select" name="intensity-select" class="form-select"><option></option></select></div>
                    <label class="col-sm-4 col-form-label my-1">Relevance Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="relevance-select" name="relevance-select" class="form-select"><option></option></select></div>
                    <label class="col-sm-4 col-form-label my-1">Likelihood Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="likelihood-select" name="likelihood-select" class="form-select"><option></option></select></div>
                    <label class="col-sm-4 col-form-label my-1">Start Year Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="start-year-select" name="start-year-select" class="form-select"><option></option></select></div>
                    <label class="col-sm-4 col-form-label my-1">End Year Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="end-year-select" name="end-year-select" class="form-select"><option></option></select></div>
                    <label class="col-sm-4 col-form-label my-1">Country Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="country-select" name="country-select" class="form-select"><option></option></select></div>
                    <label class="col-sm-4 col-form-label my-1">Region Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="region-select" name="region-select" class="form-select"><option></option></select></div>
                    <label class="col-sm-4 col-form-label my-1">Pestle Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="pestle-select" name="pestle-select" class="form-select"><option></option></select></div>
                    <label class="col-sm-4 col-form-label my-1">Topic Visualization : </label>
                    <div class="col-sm-6 my-1"><select id="topic-select" name="topic-select" class="form-select"><option></option></select></div>
                    <div class="col-sm-4 my-1"></div>
                    <button type="submit" class="btn btn-primary col-sm-4 my-1 ml-4">Submit</button>
                    </div>

                </form>
              </div>
        </div>

    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>
    <script>
        //intensity
        fetch('http://127.0.0.1:8000/api/data')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('intensity-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.intensity.intensity_id;
            optionElement.textContent = item.intensity.intensity + ' (' + item.intensity.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));
        //relevance
        fetch('http://127.0.0.1:8000/api/relevance')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('relevance-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.relevance_id;
            optionElement.textContent = item.relevance + ' (' + item.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));
        //likelihood
        fetch('http://127.0.0.1:8000/api/likelihood')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('likelihood-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.likelihood_id;
            optionElement.textContent = item.likelihood + ' (' + item.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));
        //start year
        fetch('http://127.0.0.1:8000/api/start_year/')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('start-year-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.start_year;
            optionElement.textContent = item.start_year + ' (' + item.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));        
        //end year
        fetch('http://127.0.0.1:8000/api/end_year')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('end-year-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.end_year;
            optionElement.textContent = item.end_year + ' (' + item.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));
        //country
        fetch('http://127.0.0.1:8000/api/country')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('country-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.country;
            optionElement.textContent = item.country + ' (' + item.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));
        //region
        fetch('http://127.0.0.1:8000/api/region')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('region-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.region;
            optionElement.textContent = item.region + ' (' + item.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));
        //pestel
        fetch('http://127.0.0.1:8000/api/pestle')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('pestle-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.pestle;
            optionElement.textContent = item.pestle + ' (' + item.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));
        //topic
        fetch('http://127.0.0.1:8000/api/topic')
        .then(response => response.json())
        .then(data => {
            const selectElement = document.getElementById('topic-select');
            data.forEach(item => {
            const optionElement = document.createElement('option');
            optionElement.value = item.topic;
            optionElement.textContent = item.topic + ' (' + item.count + ')';
            selectElement.appendChild(optionElement);
            });
        })
        .catch(error => console.error(error));
    </script>
</body>
</html>
