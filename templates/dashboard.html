<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visualization Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" >
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css">

  <style>
    body{
        background-color: #EEEEEE;
        color: #232931;
    }
    .card{
        border-radius: 15px;
    }
    canvas {
        display: block;
        width: 100%;
        height: auto;
    }

  </style>
</head>
<body>
    <div class='container'>
        <div class="card  my-2 mb-1" >
            <div class="card-body p-3" >
                <h1 style="padding-left : 60px">Django Dashboard</h1>
            </div>
        </div>
        <div class= "row">
            <div class='card my-2 col-6'>
                <div class="card-body">
                    <h5 class="card-title">Start Year Visualization</h5>
                    <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                    <canvas id="start-year-line"></canvas>
                </div>
            </div>
            <div class='card my-2 col-6'>
                <div class="card-body">
                    <h5 class="card-title">End Year Visualization</h5>
                    <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                    <canvas id="end-year-line"></canvas>
                </div>
            </div>
        </div>
        <div class='card my-2'>
            <div class="card-body">
                <h5 class="card-title">Intensity Visualization</h5>
                <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                <canvas id="intensity-bar-chart"></canvas>
              </div>
        </div>
        <div class='row'>
            <div class='card my-1 col-6'>
                <div class="card-body ">
                    <h5 class="card-title">Likelihood Visualization</h5>
                    <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                    <canvas id="likelihood-pie-chart"></canvas>
                </div>
            </div>
            <div class='card my-1 ml-2 col-6'>
                <div class="card-body ">
                    <h5 class="card-title">Relavance Visualization</h5>
                    <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                    <canvas id="relavance-pie-chart"></canvas>
                </div>
            </div>
        </div>

        <div class='card my-2'>
            <div class="card-body">
                <h5 class="card-title">Country Visualization</h5>
                <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                <canvas id="country-chart"></canvas>
              </div>
        </div>




        <div class='card my-2'>
            <div class="card-body">
                <h5 class="card-title">Region Visualization</h5>
                <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                <canvas id="region-chart"></canvas>
              </div>
        </div>

        <div class='card my-2'>
            <div class="card-body">
                <h5 class="card-title">Pestle Visualization</h5>
                <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                <canvas id="pestle-chart"></canvas>
              </div>
        </div>
        <div class='card my-2'>
            <div class="card-body">
                <h5 class="card-title">Topic Visualization</h5>
                <h6 class="card-subtitle mb-2 text-body-secondary"></h6>
                <canvas id="topic-chart"></canvas>
              </div>
        </div>

    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>


    <script>
 		// Intensity Visualization
        // bar-chart
         fetch('http://127.0.0.1:8000/api/intensity/')
         .then(response => response.json())
         .then(data => {
             const intensity = data.map(obj => obj.intensity);
             const count = data.map(obj => obj.count);
             new Chart('intensity-bar-chart', {
                 type: 'bar',
                 data: {
                     labels: intensity,
                     datasets: [{
                         label: 'Count',
                         data: count,
                         backgroundColor: '#007bff'
                     }]
                 },
                 options: {
                     scales: {
                         xAxes: [{
                             scaleLabel: {
                                 display: true,
                                 labelString: 'Intensity'
                             }
                         }],
                         yAxes: [{
                             scaleLabel: {
                                 display: true,
                                 labelString: 'Count'
                             },
                             ticks: {
                                 beginAtZero: true
                             }
                         }]
                     }
                 }
             });
         });

         // Likelihood pie chart
        fetch('http://127.0.0.1:8000/api/likelihood/')
        .then(response => response.json())
        .then(data => {
            const labels = data.map(obj => obj.likelihood + " - " + obj.count);
            const values = data.map(obj => obj.count);
            new Chart('likelihood-pie-chart', {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Likelihood Visualization',
                        data: values,
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF',
                            '#FF9933'
                        ]
                    }]
                },
                options: {
                    responsive: true
                }
            });
        });

         // Relavance piechart
         fetch('http://127.0.0.1:8000/api/relevance/')
         .then(response => response.json())
         .then(data => {
             const labels = data.map(obj => obj.relevance + " - " + obj.count);
             const values = data.map(obj => obj.count);
             new Chart('relavance-pie-chart', {
                 type: 'pie',
                 data: {
                     labels: labels,
                     datasets: [{
                         label: 'Relavance Visualization',
                         data: values,
                         backgroundColor: [
                             '#FF6384',
                             '#36A2EB',
                             '#FFCE56',
                             '#4BC0C0',
                             '#9966FF',
                             '#FF9933',
                             '#FF5722',
                             '#8BC34A'
                         ]
                     }]
                 },
                 options: {
                     responsive: true
                 }
             });
         });
         
        // start year line chart
        fetch('http://127.0.0.1:8000/api/start_year/')
        .then(response => response.json())
        .then(data => {
            const labels = data.map(obj => obj.start_year);
            const counts = data.map(obj => obj.count);
            new Chart('start-year-line', {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Counts',
                        data: counts,
                        fill: false,
                        borderColor: 'rgb(75, 192, 192)',
                        lineTension: 0.1
                    }]
                },
                options: {}
            });
        });

        // end year line chart
        fetch('http://127.0.0.1:8000/api/end_year/')
        .then(response => response.json())
        .then(data => {
            const labels = data.map(obj => obj.end_year);
            const counts = data.map(obj => obj.count);
            new Chart('end-year-line', {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Counts',
                        data: counts,
                        fill: false,
                        borderColor: 'rgb(75, 192, 192)',
                        lineTension: 0.1
                    }]
                },
                options: {}
            });
        });
        
        //topic bubble chart
        fetch('http://127.0.0.1:8000/api/topic/')
        .then(response => response.json())
        .then(data => {
            const topic = data.map(obj => obj.topic);
            const count = data.map(obj => obj.count);
            new Chart('topic-chart', {
                type: 'bar',
                data: {
                    labels: topic,
                    datasets: [{
                        label: 'Count',
                        data: count,
                        backgroundColor: '#007bff'
                    }]
                },
                options: {
                    scales: {
                        xAxes: [{
                            scaleLabel: {
                                display: true,
                                labelString: 'Topic'
                            }
                        }],
                        yAxes: [{
                            scaleLabel: {
                                display: true,
                                labelString: 'Count'
                            },
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        });

        // pestle-bubble
        fetch('http://127.0.0.1:8000/api/pestle/')
         .then(response => response.json())
         .then(data => {
             const labels = data.map(obj => obj.pestle);
             const values = data.map(obj => obj.count);
             new Chart('pestle-chart', {
                 type: 'doughnut',
                 data: {
                     labels: labels,
                     datasets: [{
                         label: 'Pestle Visualization',
                         data: values,
                         backgroundColor: [
                         '#FF6384',    '#36A2EB',    '#FFCE56',    '#4BC0C0',    '#9966FF',    '#FF9933',    '#009688',    '#FF5722',    '#8BC34A'
                         ]
                     }]
                 },
                 options: {
                     responsive: true
                 }
             });
         });

        //country choropleth
        fetch('http://127.0.0.1:8000/api/country/')
         .then(response => response.json())
         .then(data => {
             const country = data.map(obj => obj.country);
             const count = data.map(obj => obj.count);
             new Chart('country-chart', {
                 type: 'bar',
                 data: {
                     labels: country,
                     datasets: [{
                         label: 'Count',
                         data: count,
                         backgroundColor: '#007bff'
                     }]
                 },
                 options: {
                     scales: {
                         xAxes: [{
                             scaleLabel: {
                                 display: true,
                                 labelString: 'Country'
                             }
                         }],
                         yAxes: [{
                             scaleLabel: {
                                 display: true,
                                 labelString: 'Count'
                             },
                             ticks: {
                                 beginAtZero: true
                             }
                         }]
                     }
                 }
             });
         });

        //region chart
        fetch('http://127.0.0.1:8000/api/region/')
         .then(response => response.json())
         .then(data => {
             const region = data.map(obj => obj.region);
             const count = data.map(obj => obj.count);
             new Chart('region-chart', {
                 type: 'bar',
                 data: {
                     labels: region,
                     datasets: [{
                         label: 'Count',
                         data: count,
                         backgroundColor: '#007bff'
                     }]
                 },
                 options: {
                     scales: {
                         xAxes: [{
                             scaleLabel: {
                                 display: true,
                                 labelString: 'Region'
                             }
                         }],
                         yAxes: [{
                             scaleLabel: {
                                 display: true,
                                 labelString: 'Count'
                             },
                             ticks: {
                                 beginAtZero: true
                             }
                         }]
                     }
                 }
             });
         });

    </script>
</body>
</html>
